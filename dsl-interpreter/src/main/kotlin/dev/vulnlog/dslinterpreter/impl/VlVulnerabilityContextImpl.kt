package dev.vulnlog.dslinterpreter.impl

import dev.vulnlog.dsl.VlAnalyseInitStep
import dev.vulnlog.dsl.VlExecutionInitStep
import dev.vulnlog.dsl.VlReportInitStep
import dev.vulnlog.dsl.VlTaskInitStep
import dev.vulnlog.dsl.VlVulnerabilityContext

class VlVulnerabilityContextImpl : VlVulnerabilityContext {
    private val rBuilder = ReportBuilder()
    val aBuilder = lazy { rBuilder.build() }
    val tBuilder: Lazy<TaskBuilder> = lazy { aBuilder.value.build() }
    val eBuilder: Lazy<ExecutionBuilder> = lazy { tBuilder.value.build() }

    override var r: VlReportInitStep = VlReportInitStepImpl(rBuilder)
    override var a: VlAnalyseInitStep = VlAnalyseInitStepImpl(aBuilder)
    override var t: VlTaskInitStep = VlTaskInitStepImpl(tBuilder)
    override var e: VlExecutionInitStep = VlExecutionInitStepImpl(eBuilder)

    override var report = r
    override var analysis = a
    override var task = t
    override var execution = e
}
