package ch.addere.dsl

data class Vulnerability(
    val id: String,
    val reporter: Reporter?,
    val resolution: Resolution?,
)

class VulnerabilityBuilder : V() {
    lateinit var cve: String
    var reporter: Reporter? = null
    var resolution: Resolution? = null

    fun reporter(block: ReporterBuilder.() -> Unit) {
        val builder = ReporterBuilder()
        builder.block()
        reporter = builder.build()
    }

    fun resolution(block: ResolutionBuilder.() -> Unit) =
        with(ResolutionBuilder()) {
            block()
            resolution = this.build()
        }

    fun build(): Vulnerability = Vulnerability(cve, reporter, resolution)
}
