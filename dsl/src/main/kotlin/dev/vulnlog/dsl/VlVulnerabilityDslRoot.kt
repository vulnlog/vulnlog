package dev.vulnlog.dsl

import dev.vulnlog.dsl.definition.VlDslMarker

interface VlVulnerabilityDslRoot {
    val data: List<VulnlogData>

    /**
     * Add a vulnerability entry with a single vulnerability identifier.
     * CVE or similar identifiers are commonly used.
     *
     * @since v0.5.0
     */
    fun vuln(
        id: String,
        block: (@VlDslMarker VlVulnerabilityContext).() -> Unit,
    ): VulnlogData

    /**
     * Add a vulnerability entry with multiple vulnerability identifiers.
     * CVE or similar identifiers are commonly used. Source code scanner vendors may add their own identifiers to
     * CVE IDs. These IDs can also be added.
     *
     * @since v0.5.0
     */
    fun vuln(
        vararg id: String,
        block: (@VlDslMarker VlVulnerabilityContext).() -> Unit,
    ): VulnlogData
}
